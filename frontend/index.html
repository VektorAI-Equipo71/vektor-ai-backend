<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description"
        content="Sistema empresarial de predicci√≥n de puntualidad de vuelos con integraci√≥n meteorol√≥gica en tiempo real">
    <title>FlightOnTime - Dashboard Principal</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>

<body>
    <!-- ================================================================ -->
    <!-- HEADER EMPRESARIAL -->
    <!-- ================================================================ -->
    <header class="header">
        <div class="header-container">
            <div class="logo-section">
                <img src="/frontend/img/LogoVektorAI.svg" alt="VEKTOR AI Logo" class="logo-icon" />
                <div class="logo-text">
                    <span class="brand-name">VEKTOR AI</span>
                    <h1 class="logo-title">FlightOnTime</h1>
                </div>
            </div>
            <nav style="display: flex; gap: 1rem; align-items: center; margin-right: 1rem;">
                <a href="index.html" style="color: white; text-decoration: none; font-weight: 600;" data-i18n="nav.home">Inicio</a>
                <a href="index.html#prediccion-individual" style="color: white; text-decoration: none;" data-i18n="nav.individual">Predicci√≥n Individual</a>
                <a href="batch.html" style="color: white; text-decoration: none;" data-i18n="nav.batch">Predicci√≥n por Lote</a>
                <a href="history.html" style="color: white; text-decoration: none;" data-i18n="nav.history">Historial</a>
                <a href="stats.html" style="color: white; text-decoration: none;" data-i18n="nav.stats">Estad√≠sticas</a>
                <a href="about.html" style="color: white; text-decoration: none;" data-i18n="nav.about">Acerca de</a>
            </nav>
            <div style="display: flex; gap: 0.5rem; align-items: center;">
                <!-- Selectores de Idioma (Banderas) -->
                <button id="langEsBtn" class="lang-btn active" title="Espa√±ol" data-lang="es">
                    <img src="/frontend/img/espana.png" alt="Espa√±ol" class="lang-flag-icon">
                </button>
                <button id="langEnBtn" class="lang-btn" title="English" data-lang="en">
                    <img src="/frontend/img/estados-unidos.png" alt="English" class="lang-flag-icon">
                </button>
                <!-- Bot√≥n de Configuraci√≥n -->
                <button id="settingsBtn" class="settings-btn" title="Configuraci√≥n">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="3"/>
                        <path d="M12 1V3M12 21V23M4.22 4.22L5.64 5.64M18.36 18.36L19.78 19.78M1 12H3M21 12H23M4.22 19.78L5.64 18.36M18.36 5.64L19.78 4.22"/>
                    </svg>
                </button>
                <div class="header-status">
                    <div class="status-indicator" id="statusIndicator">
                        <span class="status-dot"></span>
                        <span class="status-text" data-i18n="header.status.operational">Sistema Operativo</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- ================================================================ -->
    <!-- DASHBOARD PRINCIPAL -->
    <!-- ================================================================ -->
    <main class="dashboard-container">
        <div class="dashboard-header">
            <h1 data-i18n="dashboard.title">Dashboard Principal</h1>
            <p data-i18n="dashboard.subtitle">Gesti√≥n completa de predicciones de puntualidad de vuelos</p>
        </div>

        <!-- Estad√≠sticas R√°pidas -->
        <div class="stats-cards" id="statsCards">
            <div class="stat-card">
                <div class="stat-card-value" id="totalPredictions">-</div>
                <div class="stat-card-label" data-i18n="dashboard.total.predictions">Total Predicciones</div>
            </div>
            <div class="stat-card">
                <div class="stat-card-value" id="todayPredictions" style="color: #00F2FF;">-</div>
                <div class="stat-card-label" data-i18n="dashboard.today.predictions">Predicciones Hoy</div>
            </div>
            <div class="stat-card">
                <div class="stat-card-value" id="delayedPercentage" style="color: var(--color-danger);">-</div>
                <div class="stat-card-label" data-i18n="dashboard.delayed.percentage">% Retrasados Hoy</div>
            </div>
            <div class="stat-card">
                <div class="stat-card-value" id="onTimePercentage" style="color: var(--color-success);">-</div>
                <div class="stat-card-label" data-i18n="dashboard.ontime.percentage">% Puntuales Hoy</div>
            </div>
        </div>

        <!-- Tarjetas de Funcionalidades -->
        <div class="dashboard-grid">
            <!-- Predicci√≥n Individual -->
            <div class="dashboard-card" onclick="scrollToPrediction()">
                <div class="dashboard-card-icon">
                    <svg viewBox="0 0 24 24" fill="none" stroke="#00F2FF" stroke-width="2">
                        <path d="M12 2L2 7L12 12L22 7L12 2Z" />
                        <path d="M2 17L12 22L22 17" />
                        <path d="M2 12L12 17L22 12" />
                    </svg>
                </div>
                <h3 data-i18n="dashboard.card.individual.title">Predicci√≥n Individual</h3>
                <p data-i18n="dashboard.card.individual.description">Realice una predicci√≥n para un vuelo espec√≠fico ingresando los datos del vuelo. Obtenga resultados instant√°neos con an√°lisis de clima y probabilidades.</p>
                <a href="#prediccion-individual" class="dashboard-card-action" onclick="event.preventDefault(); scrollToPrediction();">
                    <span data-i18n="dashboard.card.individual.action">Ir a Predicci√≥n Individual</span>
                    <svg viewBox="0 0 24 24" fill="none" style="width: 16px; height: 16px;">
                        <path d="M5 12H19M19 12L12 5M19 12L12 19" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                </a>
            </div>

            <!-- Predicci√≥n por Lote -->
            <div class="dashboard-card" onclick="window.location.href='batch.html'">
                <div class="dashboard-card-icon">
                    <svg viewBox="0 0 24 24" fill="none" stroke="#00F2FF" stroke-width="2">
                        <path d="M9 12L11 14L15 10" stroke-linecap="round"/>
                        <path d="M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z"/>
                        <path d="M9 3V7M15 3V7M3 9H7M17 9H21" stroke-linecap="round"/>
                    </svg>
                </div>
                <h3 data-i18n="dashboard.card.batch.title">Predicci√≥n por Lote</h3>
                <p data-i18n="dashboard.card.batch.description">Procese m√∫ltiples vuelos a la vez subiendo un archivo CSV. Visualice todos los resultados en una tabla con filtros avanzados.</p>
                <a href="batch.html" class="dashboard-card-action">
                    <span data-i18n="dashboard.card.batch.action">Ir a Predicci√≥n por Lote</span>
                    <svg viewBox="0 0 24 24" fill="none" style="width: 16px; height: 16px;">
                        <path d="M5 12H19M19 12L12 5M19 12L12 19" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                </a>
            </div>

            <!-- Historial de Predicciones -->
            <div class="dashboard-card" onclick="window.location.href='history.html'">
                <div class="dashboard-card-icon">
                    <svg viewBox="0 0 24 24" fill="none" stroke="#00F2FF" stroke-width="2">
                        <path d="M9 12H15M9 16H15M17 21H7C5.89543 21 5 20.1046 5 19V5C5 3.89543 5.89543 3 7 3H12.5858C12.851 3 13.1054 3.10536 13.2929 3.29289L18.7071 8.70711C18.8946 8.89464 19 9.149 19 9.41421V19C19 20.1046 18.1046 21 17 21Z"/>
                        <path d="M19 9H14V4" stroke-linecap="round"/>
                    </svg>
                </div>
                <h3 data-i18n="dashboard.card.history.title">Historial de Predicciones</h3>
                <p data-i18n="dashboard.card.history.description">Consulte todas las predicciones realizadas con filtros avanzados por fecha, aerol√≠nea, aeropuertos y tipo de predicci√≥n. Tabla paginada para f√°cil navegaci√≥n.</p>
                <a href="history.html" class="dashboard-card-action">
                    <span data-i18n="dashboard.card.history.action">Ver Historial Completo</span>
                    <svg viewBox="0 0 24 24" fill="none" style="width: 16px; height: 16px;">
                        <path d="M5 12H19M19 12L12 5M19 12L12 19" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                </a>
            </div>

            <!-- Estad√≠sticas -->
            <div class="dashboard-card" onclick="window.location.href='stats.html'">
                <div class="dashboard-card-icon">
                    <svg viewBox="0 0 24 24" fill="none" stroke="#00F2FF" stroke-width="2">
                        <path d="M3 3V21H21" stroke-linecap="round"/>
                        <path d="M7 16L12 11L16 15L21 10" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M21 10V3H14" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </div>
                <h3 data-i18n="dashboard.card.stats.title">Estad√≠sticas</h3>
                <p data-i18n="dashboard.card.stats.description">Visualice estad√≠sticas detalladas de todas las predicciones realizadas, incluyendo an√°lisis por aerol√≠nea, aeropuertos y tendencias temporales.</p>
                <a href="stats.html" class="dashboard-card-action" onclick="event.preventDefault(); window.location.href='stats.html';">
                    <span data-i18n="dashboard.card.stats.action">Ver Estad√≠sticas</span>
                    <svg viewBox="0 0 24 24" fill="none" style="width: 16px; height: 16px;">
                        <path d="M5 12H19M19 12L12 5M19 12L12 19" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                </a>
            </div>
        </div>

        <!-- Secci√≥n de Predicci√≥n Individual (Inline) -->
        <section id="prediccion-individual" class="quick-access-section" style="margin-top: 3rem;">
            <h2 data-i18n="section.individual.title">Predicci√≥n Individual de Vuelo</h2>
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title" data-i18n="form.title">Predicci√≥n de Puntualidad</h2>
                    <p class="card-description" data-i18n="form.description">Ingrese los datos del vuelo para obtener una predicci√≥n basada en ML y datos meteorol√≥gicos</p>
                </div>

                <form id="predictionForm" class="prediction-form">
                    <div class="form-group">
                        <label for="aerolinea" class="form-label">
                            <svg class="label-icon" viewBox="0 0 24 24" fill="none">
                                <path d="M12 2L2 7L12 12L22 7L12 2Z" stroke="currentColor" stroke-width="2" />
                                <path d="M2 17L12 22L22 17" stroke="currentColor" stroke-width="2" />
                                <path d="M2 12L12 17L22 12" stroke="currentColor" stroke-width="2" />
                            </svg>
                            <span data-i18n="form.airline">Aerol√≠nea</span>
                        </label>
                        <select id="aerolinea" name="aerolinea" class="form-select" required>
                            <option value="" data-i18n="form.airline.select">Seleccione una aerol√≠nea</option>
                            <!-- Opciones de aerol√≠neas se generan din√°micamente desde airline_data.js -->
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="origen" class="form-label">
                            <svg class="label-icon" viewBox="0 0 24 24" fill="none">
                                <path d="M12 2L3 7V11C3 16.55 7.84 21.74 12 23C16.16 21.74 21 16.55 21 11V7L12 2Z" stroke="currentColor" stroke-width="2" />
                            </svg>
                            <span data-i18n="form.origin">Aeropuerto de Origen</span>
                        </label>
                        <input type="text" id="origen" name="origen" class="form-input" list="origen-list" data-i18n-placeholder="form.origin.select" placeholder="Ej: JFK" required disabled style="width: 100%; padding: 0.75rem; border: 1px solid #e2e8f0; border-radius: 0.5rem;">
                        <datalist id="origen-list"></datalist>
                    </div>

                    <div class="form-group">
                        <label for="destino" class="form-label">
                            <svg class="label-icon" viewBox="0 0 24 24" fill="none">
                                <path d="M12 2L3 7V11C3 16.55 7.84 21.74 12 23C16.16 21.74 21 16.55 21 11V7L12 2Z" stroke="currentColor" stroke-width="2" />
                                <circle cx="12" cy="11" r="3" stroke="currentColor" stroke-width="2" />
                            </svg>
                            <span data-i18n="form.destination">Aeropuerto de Destino</span>
                        </label>
                        <input type="text" id="destino" name="destino" class="form-input" list="destino-list" data-i18n-placeholder="form.destination.select" placeholder="Ej: LAX" required disabled style="width: 100%; padding: 0.75rem; border: 1px solid #e2e8f0; border-radius: 0.5rem;">
                        <datalist id="destino-list"></datalist>
                    </div>

                    <div class="form-group">
                        <label for="fechaVuelo" class="form-label">
                            <svg class="label-icon" viewBox="0 0 24 24" fill="none">
                                <rect x="3" y="4" width="18" height="18" rx="2" stroke="currentColor" stroke-width="2" />
                                <path d="M16 2V6M8 2V6M3 10H21" stroke="currentColor" stroke-width="2" />
                            </svg>
                            <span data-i18n="form.flight.date">Fecha de Vuelo</span>
                        </label>
                        <input type="date" id="fechaVuelo" name="fechaVuelo" class="form-input" required>
                    </div>

                    <div class="form-group">
                        <label for="horaVuelo" class="form-label">
                            <svg class="label-icon" viewBox="0 0 24 24" fill="none">
                                <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" />
                                <path d="M12 6V12L16 14" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                            </svg>
                            <span data-i18n="form.flight.time">Hora de Vuelo</span>
                        </label>
                        <input type="time" id="horaVuelo" name="horaVuelo" class="form-input" required>
                    </div>

                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary" id="submitBtn">
                            <svg class="btn-icon" viewBox="0 0 24 24" fill="none">
                                <path d="M9 11L12 14L22 4" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                                <path d="M21 12V19C21 20.1046 20.1046 21 19 21H5C3.89543 21 3 20.1046 3 19V5C3 3.89543 3.89543 3 5 3H16" stroke="currentColor" stroke-width="2" />
                            </svg>
                            <span id="btnText" data-i18n="form.submit">Obtener Predicci√≥n</span>
                        </button>
                        <button type="button" class="btn btn-secondary" id="clearFormBtnTop" onclick="clearForm()" style="display: none;">
                            <svg class="btn-icon" viewBox="0 0 24 24" fill="none">
                                <path d="M19 7L18.1327 19.1425C18.0579 20.1891 17.187 21 16.1378 21H7.86224C6.81296 21 5.94208 20.1891 5.86732 19.1425L5 7M10 11V17M14 11V17M15 7V4C15 3.44772 14.5523 3 14 3H10C9.44772 3 9 3.44772 9 4V7M4 7H20" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            <span data-i18n="button.clear.form">Limpiar Formulario</span>
                        </button>
                    </div>
                </form>
            </div>

            <!-- Secci√≥n de Resultados -->
            <section class="results-section" id="resultsSection" style="display: none; margin-top: 2rem;">
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title" data-i18n="results.title">Resultado de la Predicci√≥n</h2>
                    </div>

                    <div class="prediction-result" id="predictionResult">
                        <div class="prediction-icon" id="predictionIcon"></div>
                        <div class="prediction-content">
                            <h3 class="prediction-status" id="predictionStatus">Puntual</h3>
                            <p class="prediction-subtitle" id="predictionSubtitle">El vuelo tiene alta probabilidad de despegar a tiempo</p>
                        </div>
                    </div>

                    <div class="metrics-grid">
                        <div class="metric-card">
                            <div class="metric-label">Probabilidad de Retraso</div>
                            <div class="metric-value" id="metricProbability">0%</div>
                            <div class="metric-bar">
                                <div class="metric-bar-fill" id="probabilityBar"></div>
                            </div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-label">Confianza del Modelo</div>
                            <div class="metric-value" id="metricConfidence">0%</div>
                            <div class="metric-bar">
                                <div class="metric-bar-fill confidence" id="confidenceBar"></div>
                            </div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-label">Distancia del Vuelo</div>
                            <div class="metric-value" id="metricDistance">0 km</div>
                        </div>
                    </div>

                    <div class="weather-container-split" style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 2rem;">
                        <div class="weather-section" id="weatherSectionOrigin">
                            <h4 class="section-subtitle">Clima en Origen</h4>
                            <div class="weather-grid">
                                <div class="weather-item">
                                    <span class="weather-label">Condici√≥n</span>
                                    <span class="weather-value" id="weatherCondition"></span>
                                </div>
                                <div class="weather-item">
                                    <span class="weather-label">Temperatura</span>
                                    <span class="weather-value" id="weatherTemp"></span>
                                </div>
                                <div class="weather-item">
                                    <span class="weather-label">Humedad</span>
                                    <span class="weather-value" id="weatherHumidity"></span>
                                </div>
                                <div class="weather-item">
                                    <span class="weather-label">Viento</span>
                                    <span class="weather-value" id="weatherWind"></span>
                                </div>
                                <div class="weather-item">
                                    <span class="weather-label">Visibilidad</span>
                                    <span class="weather-value" id="weatherVisibility"></span>
                                </div>
                            </div>
                        </div>

                        <div class="weather-section" id="weatherSectionDest">
                            <h4 class="section-subtitle">Clima en Destino</h4>
                            <div class="weather-grid">
                                <div class="weather-item">
                                    <span class="weather-label">Condici√≥n</span>
                                    <span class="weather-value" id="weatherConditionDest"></span>
                                </div>
                                <div class="weather-item">
                                    <span class="weather-label">Temperatura</span>
                                    <span class="weather-value" id="weatherTempDest"></span>
                                </div>
                                <div class="weather-item">
                                    <span class="weather-label">Humedad</span>
                                    <span class="weather-value" id="weatherHumidityDest"></span>
                                </div>
                                <div class="weather-item">
                                    <span class="weather-label">Viento</span>
                                    <span class="weather-value" id="weatherWindDest"></span>
                                </div>
                                <div class="weather-item">
                                    <span class="weather-label">Visibilidad</span>
                                    <span class="weather-value" id="weatherVisibilityDest"></span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="metadata-section" id="metadataSection">
                        <h4 class="section-subtitle">Informaci√≥n del Vuelo</h4>
                        <div class="metadata-grid" id="metadataGrid"></div>
                    </div>

                    <!-- Bot√≥n para limpiar formulario y realizar nueva consulta -->
                    <div class="form-actions" style="margin-top: 2rem; padding-top: 1.5rem; border-top: 1px solid #e2e8f0; justify-content: center;">
                        <button type="button" class="btn btn-secondary" id="clearFormBtn" onclick="clearForm()" style="max-width: 300px;">
                            <svg class="btn-icon" viewBox="0 0 24 24" fill="none">
                                <path d="M19 7L18.1327 19.1425C18.0579 20.1891 17.187 21 16.1378 21H7.86224C6.81296 21 5.94208 20.1891 5.86732 19.1425L5 7M10 11V17M14 11V17M15 7V4C15 3.44772 14.5523 3 14 3H10C9.44772 3 9 3.44772 9 4V7M4 7H20" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            <span data-i18n="button.new.query">Nueva Consulta</span>
                        </button>
                    </div>
                </div>
            </section>
        </section>

        <!-- Panel de Configuraci√≥n -->
        <div id="settingsPanel" class="settings-panel">
            <div class="settings-panel-content">
                <div class="settings-panel-header">
                    <h2 data-i18n="settings.title">Configuraci√≥n</h2>
                    <button id="settingsClose" class="settings-close-btn" aria-label="Cerrar">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M18 6L6 18M6 6L18 18"/>
                        </svg>
                    </button>
                </div>
                
                <div class="settings-section">
                    <h3 data-i18n="settings.language">Idioma</h3>
                    <div class="settings-options">
                        <button id="langEs" class="settings-option active" data-lang="es">
                            <div style="display: flex; align-items: center; gap: 0.5rem;">
                                <img src="/espana.png" alt="Espa√±ol" style="width: 24px; height: 24px; border-radius: 50%; object-fit: contain;">
                                <span>Espa√±ol</span>
                            </div>
                        </button>
                        <button id="langEn" class="settings-option" data-lang="en">
                            <div style="display: flex; align-items: center; gap: 0.5rem;">
                                <img src="/estados-unidos.png" alt="English" style="width: 24px; height: 24px; border-radius: 50%; object-fit: contain;">
                                <span>English</span>
                            </div>
                        </button>
                    </div>
                </div>

                <div class="settings-section">
                    <h3 data-i18n="settings.units">Sistema de Unidades</h3>
                    <div class="settings-options">
                        <button id="unitKm" class="settings-option active" data-unit="km">
                            <div>
                                <strong>Sistema Internacional (SI)</strong>
                                <span class="settings-option-desc">Kil√≥metros (km) ‚Ä¢ Celsius (¬∞C) ‚Ä¢ m/s</span>
                            </div>
                        </button>
                        <button id="unitMiles" class="settings-option" data-unit="miles">
                            <div>
                                <strong>Imperial</strong>
                                <span class="settings-option-desc">Millas (mi) ‚Ä¢ Fahrenheit (¬∞F) ‚Ä¢ mph</span>
                            </div>
                        </button>
                    </div>
                </div>

                <div class="settings-info">
                    <p data-i18n="settings.save.info" style="font-size: 0.85rem; color: var(--color-gray-600); margin: 0; padding: 1rem; background: var(--color-gray-50); border-radius: 8px;">
                        üí° Las preferencias se guardan autom√°ticamente y se aplicar√°n en toda la aplicaci√≥n.
                    </p>
                </div>
            </div>
        </div>

        <!-- Modal de Estad√≠sticas -->
        <div id="statsModal" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 1000; align-items: center; justify-content: center;">
            <div style="background: white; border-radius: 12px; padding: 2rem; max-width: 800px; max-height: 90vh; overflow-y: auto; margin: 2rem;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                    <h2 style="margin: 0;">Estad√≠sticas de Predicciones</h2>
                    <button onclick="closeStats()" style="background: none; border: none; font-size: 1.5rem; cursor: pointer; color: #666;">√ó</button>
                </div>
                <div id="statsContent"></div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <p data-i18n="footer.text">&copy; 2026 FlightOnTime | Sistema de Misi√≥n Cr√≠tica</p>
    </footer>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner"></div>
        <p class="loading-text">Analizando datos de vuelo y clima...</p>
    </div>

    <script src="i18n.js"></script>
    <script src="airline_data.js"></script>
    <script src="app.js"></script>
    <script>
        const API_BASE_URL = 'http://localhost:8080/api';

        // Cargar estad√≠sticas al iniciar
        window.addEventListener('DOMContentLoaded', () => {
            loadQuickStats();
        });

        // Cargar estad√≠sticas r√°pidas
        async function loadQuickStats() {
            try {
                const response = await fetch(`${API_BASE_URL}/stats`);
                const data = await response.json();
                
                document.getElementById('totalPredictions').textContent = data.total_predicciones || 0;
                document.getElementById('todayPredictions').textContent = data.total_predicciones || 0;
                document.getElementById('delayedPercentage').textContent = (data.porcentaje_retrasados || 0) + '%';
                document.getElementById('onTimePercentage').textContent = (data.porcentaje_puntuales || 0) + '%';
            } catch (error) {
                console.error('Error cargando estad√≠sticas:', error);
            }
        }

        // Mostrar estad√≠sticas en modal
        async function showStats() {
            const modal = document.getElementById('statsModal');
            const content = document.getElementById('statsContent');
            
            try {
                content.innerHTML = '<p>Cargando estad√≠sticas...</p>';
                modal.style.display = 'flex';
                
                const response = await fetch(`${API_BASE_URL}/stats`);
                const data = await response.json();
                
                let html = `
                    <div style="margin-bottom: 2rem;">
                        <h3 style="margin-bottom: 1rem;">Resumen del D√≠a</h3>
                        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem;">
                            <div style="padding: 1rem; background: #f8f9fa; border-radius: 8px;">
                                <div style="font-size: 1.5rem; font-weight: 600; color: #4A90E2;">${data.total_predicciones || 0}</div>
                                <div style="color: #666; font-size: 0.9rem;">Total Predicciones</div>
                            </div>
                            <div style="padding: 1rem; background: #f8f9fa; border-radius: 8px;">
                                <div style="font-size: 1.5rem; font-weight: 600; color: #dc3545;">${data.total_retrasados || 0}</div>
                                <div style="color: #666; font-size: 0.9rem;">Retrasados</div>
                            </div>
                            <div style="padding: 1rem; background: #f8f9fa; border-radius: 8px;">
                                <div style="font-size: 1.5rem; font-weight: 600; color: #28a745;">${data.total_puntuales || 0}</div>
                                <div style="color: #666; font-size: 0.9rem;">Puntuales</div>
                            </div>
                            <div style="padding: 1rem; background: #f8f9fa; border-radius: 8px;">
                                <div style="font-size: 1.5rem; font-weight: 600; color: #dc3545;">${data.porcentaje_retrasados || 0}%</div>
                                <div style="color: #666; font-size: 0.9rem;">% Retrasados</div>
                            </div>
                        </div>
                    </div>
                `;

                if (data.estadisticas_por_aerolinea && data.estadisticas_por_aerolinea.length > 0) {
                    html += `
                        <div style="margin-bottom: 2rem;">
                            <h3 style="margin-bottom: 1rem;">Por Aerol√≠nea</h3>
                            <div style="display: grid; gap: 1rem;">
                    `;
                    data.estadisticas_por_aerolinea.forEach(stat => {
                        const aerolineaName = stat.aerolinea === '1' ? 'Delta Air Lines' : stat.aerolinea === '2' ? 'Southwest Airlines' : stat.aerolinea;
                        html += `
                            <div style="padding: 1rem; background: #f8f9fa; border-radius: 8px;">
                                <div style="font-weight: 600; margin-bottom: 0.5rem;">${aerolineaName}</div>
                                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem; font-size: 0.9rem;">
                                    <div>Total: ${stat.total}</div>
                                    <div>Retrasados: ${stat.retrasados}</div>
                                    <div>% Retrasados: ${stat.porcentaje_retrasados}%</div>
                                </div>
                            </div>
                        `;
                    });
                    html += `</div></div>`;
                }

                if (data.estadisticas_por_aeropuerto_origen && data.estadisticas_por_aeropuerto_origen.length > 0) {
                    html += `
                        <div>
                            <h3 style="margin-bottom: 1rem;">Por Aeropuerto de Origen</h3>
                            <div style="display: grid; gap: 1rem; max-height: 300px; overflow-y: auto;">
                    `;
                    data.estadisticas_por_aeropuerto_origen.forEach(stat => {
                        html += `
                            <div style="padding: 1rem; background: #f8f9fa; border-radius: 8px;">
                                <div style="font-weight: 600; margin-bottom: 0.5rem;">${stat.aeropuerto}</div>
                                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem; font-size: 0.9rem;">
                                    <div>Total: ${stat.total}</div>
                                    <div>Retrasados: ${stat.retrasados}</div>
                                    <div>% Retrasados: ${stat.porcentaje_retrasados}%</div>
                                </div>
                            </div>
                        `;
                    });
                    html += `</div></div>`;
                }

                content.innerHTML = html;
            } catch (error) {
                content.innerHTML = `<p style="color: #dc3545;">Error al cargar estad√≠sticas: ${error.message}</p>`;
            }
        }

        function closeStats() {
            document.getElementById('statsModal').style.display = 'none';
        }

        // Cerrar modal al hacer clic fuera
        document.getElementById('statsModal').addEventListener('click', (e) => {
            if (e.target.id === 'statsModal') {
                closeStats();
            }
        });

        // Scroll suave a la secci√≥n de predicci√≥n individual
        function scrollToPrediction() {
            document.getElementById('prediccion-individual').scrollIntoView({ 
                behavior: 'smooth',
                block: 'start'
            });
        }
    </script>
</body>

</html>
